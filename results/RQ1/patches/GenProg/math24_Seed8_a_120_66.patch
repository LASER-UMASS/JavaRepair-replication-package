--- ./original/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java	2016-10-18 22:37:55.000000000 +0000
+++ ./variant199/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java	2016-10-19 12:56:18.000000000 +0000
@@ -240,7 +240,27 @@
                     }
                     v = w;
                     fv = fw;
-                    w = x;
+                    {
+						w = x;
+						if (p > q * (a - x) && p < q * (b - x) && FastMath.abs(p) < FastMath.abs(0.5 * q * r)) {
+							d = p / q;
+							u = x + d;
+							if (u - a < tol2 || b - u < tol2) {
+								if (x <= m) {
+									d = tol1;
+								} else {
+									d = -tol1;
+								}
+							}
+						} else {
+							if (x < m) {
+								e = b - x;
+							} else {
+								e = a - x;
+							}
+							d = GOLDEN_SECTION * e;
+						}
+					}
                     fw = fx;
                     x = u;
                     fx = fu;
